<?xml version="1.0" encoding="utf-8" ?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             x:Class="BilheticaAeronautica.Mobile.Pages.FlightsPage"
             Title="Flights">

    <ScrollView>
        
        
        
        
    <VerticalStackLayout Padding="20" Spacing="15">



        <!-- Origin Airport -->
        <Label Text="Origin Airport" FontAttributes="Bold"/>
        <SearchBar x:Name="OriginSearchBar"
               Placeholder="Search origin airport"
               TextChanged="OnOriginSearchTextChanged"/>

        <CollectionView x:Name="OriginAirportsList"
                    HeightRequest="150"
                    SelectionMode="Single"
                    SelectionChanged="OnOriginAirportSelected">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Label Text="{Binding Name}" Padding="10"/>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>


        <!-- Destination Airport -->
        <Label Text="Destination Airport" FontAttributes="Bold"/>
        <SearchBar x:Name="DestinationSearchBar"
               Placeholder="Search destination airport"
               TextChanged="OnDestinationSearchTextChanged"/>

        <CollectionView x:Name="DestinationAirportsList"
                    HeightRequest="150"
                    SelectionMode="Single"
                    SelectionChanged="OnDestinationAirportSelected">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Label Text="{Binding Name}" Padding="10"/>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

            <!-- Toggle for Return Flight -->
            <HorizontalStackLayout>
                <Label Text="Round-trip?" VerticalOptions="Center"/>
                <Switch x:Name="RoundTripSwitch" Toggled="RoundTripSwitch_Toggled"/>
            </HorizontalStackLayout>

            <!-- Departure Date -->
            <DatePicker x:Name="DepartureDatePicker"
                DateSelected="DepartureDatePicker_DateSelected"
                MinimumDate="{x:Static sys:DateTime.Today}"
                Format="dd MMM yyyy" />

            <!-- Return Date (hidden by default) -->
            <DatePicker x:Name="ReturnDatePicker"
                IsVisible="False"
                DateSelected="ReturnDatePicker_DateSelected"
                MinimumDate="{x:Static sys:DateTime.Today}"
                Format="dd MMM yyyy" />

        <Button Text="Load Flights" x:Name="BtnLoadFlights" Clicked="BtnLoadFlights_Clicked"/>


            <Label Text="Select Departure Flight"
                   FontAttributes="Bold"
                   FontSize="18"/>

            <CollectionView x:Name="FlightList"
                SelectionMode="Single"
                SelectionChanged="FlightList_SelectionChanged"
                HeightRequest="200">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border Padding="10" Stroke="#87A7AC" StrokeShape="RoundRectangle 10">
                        <Grid RowDefinitions="Auto,Auto,Auto" ColumnDefinitions="2*,8*" ColumnSpacing="10">
                            <Label Grid.Row="1" Grid.Column="1" Text="{Binding Date}" />
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

            <Label Text="Select Return Flight"
                   FontAttributes="Bold"
                   FontSize="18"
                   Margin="0,20,0,0"/>

            <CollectionView x:Name="ReturnFlightsList"
                            SelectionMode="Single"
                            SelectionChanged="OnReturnFlightSelected"
                            HeightRequest="200"
                            IsEnabled="False"
                            Opacity="0.5">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border Padding="10" Stroke="#87A7AC" StrokeShape="RoundRectangle 10" Margin="0,5">
                            <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="2*,8*" ColumnSpacing="10">
                                <Label Grid.Row="1" Grid.Column="1" Text="{Binding Date}" />
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <Button Text="Select Flight" x:Name="BtnSelectFlight" Clicked="BtnSelectFlight_Clicked"/>

    </VerticalStackLayout>
    </ScrollView>
</ContentPage>
